<!DOCTYPE html>
<html>
<head>
    <title>Blog - colorBanded</title>
    <style type="text/css">
        body {
            font-family: "Verdana", "Arial", sans-serif;
            margin: 0;
            padding: 20px 0 0 0;
            background-color: #f6f6f6;
            color: #333333;
            font-size: 12px;
            line-height: 1.4;
        }
        
        #container {
            width: 960px;
            margin: 0 auto;
            border: 1px solid #cccccc;
            background-color: #ffffff;
            position: relative;
        }

        #container:before, #container:after {
            content: "";
            position: absolute;
            z-index: -1;
            background: #999999;
            bottom: 15px;
            width: 50%;
            height: 20px;
            box-shadow: 0 15px 10px #999999;
        }

        #container:before {
            left: 10px;
            transform: rotate(-3deg);
        }

        #container:after {
            right: 10px;
            transform: rotate(3deg);
        }

        #shadow-container {
            width: 980px;
            margin: 0 auto;
            background: url('data:image/gif;base64,R0lGODlhZAAFAIAAAP///8zMzCH5BAAAAAAALAAAAABkAAUAAAIPhI+py+0Po5y02ouz3rwXADs=') repeat-y center;
            padding: 0 10px;
        }
        
        #header {
            background: #e0e8f0;
            background-image: url('data:image/gif;base64,R0lGODlhAQAcAIAAAODg4P///yH5BAAAAAAALAAAAAABABwAAAIIhI+py+0PYysAOw==');
            border-bottom: 1px solid #aaaaaa;
            height: 80px;
            padding: 10px;
        }
        
        #header h1 {
            margin: 0;
            padding: 0;
            font-size: 24px;
            color: #333333;
            font-weight: normal;
        }
        
        #header p {
            margin: 5px 0 0 0;
            font-size: 11px;
            color: #666666;
        }
        
        #navigation {
            float: left;
            width: 180px;
            background-color: #f8f8f8;
            border-right: 1px solid #dddddd;
            padding: 10px;
            min-height: 500px;
        }
        
        #navigation ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }
        
        #navigation li {
            margin-bottom: 5px;
        }
        
        #navigation a {
            display: block;
            padding: 5px;
            border: 1px solid #dddddd;
            background-color: #f0f0f0;
            color: #0066cc;
            text-decoration: none;
            font-weight: bold;
        }
        
        #navigation a:hover {
            background-color: #e0e0e0;
            border-color: #bbbbbb;
            text-decoration: underline;
        }

        #navigation a.current {
            background-color: #d0d8e0;
            border-color: #999999;
            color: #003366;
        }
        
        #content {
            margin-left: 200px;
            padding: 15px;
        }
        
        .section {
            margin-bottom: 20px;
            border: 1px solid #dddddd;
            background-color: #ffffff;
        }
        
        .section-header {
            background-color: #f0f0f0;
            border-bottom: 1px solid #dddddd;
            padding: 5px 10px;
            font-weight: bold;
            color: #333333;
        }
        
        .section-content {
            padding: 10px;
        }

        .blog-post {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dotted #cccccc;
        }

        .blog-post:last-child {
            border-bottom: none;
        }

        .blog-post h3 {
            margin-top: 0;
            margin-bottom: 5px;
            color: #0066cc;
        }

        .blog-post h3 a {
            color: #0066cc;
            text-decoration: none;
        }

        .blog-post h3 a:hover {
            text-decoration: underline;
        }

        .blog-meta {
            font-size: 11px;
            color: #666666;
            font-style: italic;
            margin-bottom: 8px;
        }

        .blog-excerpt {
            margin-bottom: 8px;
        }

        .blog-tags {
            font-size: 10px;
            color: #999999;
        }

        .blog-tags a {
            color: #0066cc;
            text-decoration: none;
            margin-right: 5px;
        }

        .blog-tags a:hover {
            text-decoration: underline;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666666;
            font-style: italic;
        }

        .error {
            background-color: #ffe6e6;
            border: 1px solid #ffcccc;
            padding: 10px;
            color: #cc0000;
        }

        .info {
            background-color: #e6f3ff;
            border: 1px solid #b3d9ff;
            padding: 10px;
            color: #0066cc;
            margin-bottom: 15px;
        }

        /* Blog post content styles */
        .blog-content {
            line-height: 1.6;
        }

        .blog-content h1, .blog-content h2, .blog-content h3 {
            color: #333333;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .blog-content h1 {
            font-size: 18px;
            border-bottom: 1px solid #dddddd;
            padding-bottom: 5px;
        }

        .blog-content h2 {
            font-size: 16px;
        }

        .blog-content h3 {
            font-size: 14px;
        }

        .blog-content p {
            margin-bottom: 10px;
        }

        .blog-content code {
            background-color: #f0f0f0;
            border: 1px solid #dddddd;
            padding: 2px 4px;
            font-family: "Courier New", monospace;
            font-size: 11px;
        }

        .blog-content pre {
            background-color: #f8f8f8;
            border: 1px solid #dddddd;
            padding: 10px;
            overflow-x: auto;
            font-family: "Courier New", monospace;
            font-size: 11px;
        }

        .blog-content blockquote {
            border-left: 3px solid #cccccc;
            margin-left: 0;
            padding-left: 15px;
            color: #666666;
            font-style: italic;
        }

        .back-to-blog {
            margin-bottom: 15px;
        }

        .back-to-blog a {
            color: #0066cc;
            text-decoration: none;
            font-size: 11px;
        }

        .back-to-blog a:hover {
            text-decoration: underline;
        }
        
        #footer {
            clear: both;
            background-color: #f0f0f0;
            border-top: 1px solid #dddddd;
            padding: 10px;
            text-align: center;
            font-size: 11px;
            color: #666666;
        }
        
        a {
            color: #0066cc;
            text-decoration: underline;
        }
        
        a:hover {
            color: #003366;
        }
    </style>
</head>
<body>
    <div id="shadow-container">
        <div id="container">
            <div id="header">
                <h1>colorBanded</h1>
                <p>computer person thing</p>
            </div>
            
            <div id="navigation">
                <ul>
                    <li><a href="index.html">About Me</a></li>
                    <li><a href="blog.html" class="current">Blog</a></li>
                    <li><a href="links.html">Links & Cont</a></li>
                </ul>
                
                <div id="blog-stats" style="margin-top: 20px; padding: 10px; border: 1px dashed #cccccc; background-color: #ffffcc; font-size: 11px;">
                    <strong>Blog Stats:</strong><br>
                    Total Posts: <span id="post-count">Loading...</span><br>
                    Last Post: <span id="last-post-date">Loading...</span>
                </div>

                <div style="margin-top: 15px; padding: 8px; border: 1px solid #cccccc; background-color: #f0f8ff; font-size: 10px;">
                    <strong>Hosted on:</strong><br>
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMEMzLjU4IDAgMCAzLjU4IDAgOEMwIDExLjU0IDIuMjkgMTQuNTMgNS40NyAxNS41OUM1Ljg3IDE1LjY2IDYuMDIgMTUuNDIgNi4wMiAxNS4yMUM2LjAyIDE1LjAyIDYuMDEgMTQuMzkgNi4wMSAxMy43MkM0IDE0LjA5IDMuNDggMTIuNjggMy4yOCAxMS45NUMzLjE3IDExLjU3IDIuNzggMTAuOTYgMi40NCAxMC43NkMyLjE1IDEwLjYgMS43MSAxMC4yMyAxLjcgMTAuMjNDMS43IDEwLjIzIDIuNDQgMTAuMzEgMi44OCAxMC44OEMzLjMgMTEuNDUgMy45NyAxMS4yNCA0LjI4IDExLjA5QzQuMzQgMTAuNTcgNC41NCAxMC4zNSA0Ljc2IDEwLjIyQzMuNDcgMTAuMDkgMi4xNCA5LjU2IDIuMTQgNi44MUMyLjE0IDYuMDMgMi40MiA1LjM5IDIuODkgNC44OUMyLjgyIDQuNzYgMi42IDQuMDMgMi45NiAzLjA2QzIuOTYgMy4wNiAzLjUgMi44NyA2IDQuNzVDNi41IDQuNjMgNy4yNSA0LjU3IDggNC41N0M4Ljc1IDQuNTcgOS41IDQuNjMgMTAgNC43NUMxMi41IDIuODcgMTMuMDQgMy4wNiAxMy4wNCAzLjA2QzEzLjQgNC4wMyAxMy4xOCA0Ljc2IDEzLjExIDQuODlDMTMuNTggNS4zOSAxMy44NiA2LjAzIDEzLjg2IDYuODFDMTMuODYgOS41NiAxMi41MyAxMC4wOSAxMS4yNCAxMC4yMkMxMS40NiAxMC40NSAxMS42NiAxMC44NyAxMS42NiAxMS41M0MxMS42NiAxMi41IDExLjY1IDEzLjI3IDExLjY1IDE1LjIxQzExLjY1IDE1LjQyIDExLjggMTUuNjYgMTIuMiAxNS41OUMxNS43MSAxNC41MyAxNiAxMS41NCAxNiA4QzE2IDMuNTggMTIuNDIgMCA4IDBaIiBmaWxsPSIjMjQyOTJFIi8+Cjwvc3ZnPgo=" alt="GitHub" style="vertical-align: middle; margin-right: 3px;">
                    GitHub Pages
                </div>
            </div>
            
            <div id="content">
                <!-- Blog listing view -->
                <div id="blog-listing">
                    <div class="section">
                        <div class="section-header">Latest Blog Posts</div>
                        <div class="section-content">
                            <div class="info"><strong>Feel Free to look around! </strong>Ill post stuff here occasionally.</div>
                            <div id="posts-container" class="loading">
                                Scanning for blog posts...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Individual blog post view -->
                <div id="blog-post" style="display: none;">
                    <div class="back-to-blog">
                        <a href="blog.html">&laquo; Back to Blog</a>
                    </div>
                    <div class="section">
                        <div class="section-header" id="post-title">Blog Post</div>
                        <div class="section-content">
                            <div id="post-meta" class="blog-meta"></div>
                            <div id="post-content" class="blog-content"></div>
                            <div id="post-tags" class="blog-tags"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="footer">
                &copy; 2025 colorBanded | Hosted on <a href="https://pages.github.com/" target="_blank">GitHub Pages</a> | <a href="#" onclick="alert('Under construction!'); return false;">Site Map</a><br>
                Best viewed in LibreWolf Browser - Github.com/colorbanded
            </div>
        </div>
    </div>
    
<script type="text/javascript">
// GitHub repository configuration
const GITHUB_REPO = {
    owner: 'colorBanded',
    repo: 'colorBanded.github.io',
    branch: 'main',
    postsFolder: 'posts'
};

console.log('Blog script loaded for GitHub Pages, will auto-discover files from:', `${GITHUB_REPO.owner}/${GITHUB_REPO.repo}/${GITHUB_REPO.postsFolder}`);

// Simple markdown parser function
function parseMarkdown(markdown) {
    let html = markdown;
    
    // Headers
    html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
    html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
    html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');
    
    // Bold
    html = html.replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>');
    html = html.replace(/__(.*?)__/gim, '<strong>$1</strong>');
    
    // Italic
    html = html.replace(/\*(.*?)\*/gim, '<em>$1</em>');
    html = html.replace(/_(.*?)_/gim, '<em>$1</em>');
    
    // Code blocks
    html = html.replace(/```([\s\S]*?)```/gim, '<pre><code>$1</code></pre>');
    
    // Inline code
    html = html.replace(/`(.*?)`/gim, '<code>$1</code>');
    
    // Links
    html = html.replace(/\[([^\]]*)\]\(([^)]*)\)/gim, '<a href="$2">$1</a>');
    
    // Blockquotes
    html = html.replace(/^> (.*$)/gim, '<blockquote>$1</blockquote>');
    
    // Line breaks
    html = html.replace(/\n\n/gim, '</p><p>');
    html = '<p>' + html + '</p>';
    
    // Clean up empty paragraphs
    html = html.replace(/<p><\/p>/gim, '');
    html = html.replace(/<p>(<h[1-6]>)/gim, '$1');
    html = html.replace(/(<\/h[1-6]>)<\/p>/gim, '$1');
    html = html.replace(/<p>(<pre>)/gim, '$1');
    html = html.replace(/(<\/pre>)<\/p>/gim, '$1');
    html = html.replace(/<p>(<blockquote>)/gim, '$1');
    html = html.replace(/(<\/blockquote>)<\/p>/gim, '$1');
    
    return html;
}

// Parse frontmatter from content
function parseFrontmatter(content) {
    console.log('Parsing frontmatter for content length:', content.length);
    
    const frontmatterRegex = /^---\s*\r?\n([\s\S]*?)\r?\n---\s*\r?\n([\s\S]*)$/;
    const match = content.match(frontmatterRegex);
    
    if (!match) {
        console.log('No frontmatter found, trying alternative format...');
        // Try without the final newline requirement
        const altRegex = /^---\s*\r?\n([\s\S]*?)\r?\n---\s*([\s\S]*)$/;
        const altMatch = content.match(altRegex);
        
        if (!altMatch) {
            console.log('No frontmatter found at all');
            return {
                frontmatter: {},
                content: content
            };
        }
        
        const frontmatterText = altMatch[1];
        const markdownContent = altMatch[2];
        const frontmatter = {};
        
        frontmatterText.split(/\r?\n/).forEach(line => {
            const colonIndex = line.indexOf(':');
            if (colonIndex > -1) {
                const key = line.substring(0, colonIndex).trim();
                const value = line.substring(colonIndex + 1).trim().replace(/^["']|["']$/g, '');
                frontmatter[key] = value;
            }
        });
        
        return {
            frontmatter: frontmatter,
            content: markdownContent.trim()
        };
    }
    
    const frontmatterText = match[1];
    const markdownContent = match[2];
    const frontmatter = {};
    
    console.log('Found frontmatter:', frontmatterText);
    
    frontmatterText.split(/\r?\n/).forEach(line => {
        const colonIndex = line.indexOf(':');
        if (colonIndex > -1) {
            const key = line.substring(0, colonIndex).trim();
            const value = line.substring(colonIndex + 1).trim().replace(/^["']|["']$/g, '');
            frontmatter[key] = value;
        }
    });
    
    console.log('Parsed frontmatter:', frontmatter);
    
    return {
        frontmatter: frontmatter,
        content: markdownContent.trim()
    };
}

// Extract excerpt from content
function extractExcerpt(content, maxLength = 150) {
    let excerpt = content
        .replace(/^---[\s\S]*?---\s*/gm, '')
        .replace(/#{1,6}\s+/g, '')
        .replace(/\*\*(.*?)\*\*/g, '$1')
        .replace(/\*(.*?)\*/g, '$1')
        .replace(/<pre><code>(.*?)<\/code><\/pre>/g, '$1')
        .replace(/\[([^\]]*)\]\([^)]*\)/g, '$1')
        .replace(/\s+/g, ' ')
        .trim();
    
    if (excerpt.length > maxLength) {
        excerpt = excerpt.substring(0, maxLength) + '...';
    }
    
    return excerpt || 'Click to read more...';
}

// Fixed getPostFilesFromGitHub function with better error handling
async function getPostFilesFromGitHub() {
    try {
        const apiUrl = `https://api.github.com/repos/${GITHUB_REPO.owner}/${GITHUB_REPO.repo}/contents/${GITHUB_REPO.postsFolder}`;
        console.log('Fetching file list from GitHub API:', apiUrl);
        
        const response = await fetch(apiUrl);
        console.log('GitHub API response status:', response.status);
        
        if (!response.ok) {
            // If GitHub API fails, try a fallback approach
            if (response.status === 404) {
                console.log('Posts folder not found via API, trying fallback');
                return ['hello-world.md', 'test-post.md']; // Add your known files here
            }
            throw new Error(`GitHub API request failed: ${response.status} ${response.statusText}`);
        }
        
        const files = await response.json();
        console.log('GitHub API response data:', files);
        
        if (!Array.isArray(files)) {
            console.error('GitHub API returned non-array:', files);
            return [];
        }
        
        // Filter for markdown files
        const markdownFiles = files
            .filter(file => file.type === 'file' && file.name.endsWith('.md'))
            .map(file => file.name);
        
        console.log('Found markdown files:', markdownFiles);
        return markdownFiles;
        
    } catch (error) {
        console.error('Error fetching files from GitHub API:', error);
        // Fallback to manual list if API fails
        console.log('Using fallback file list');
        return ['hello-world.md']; // Add your known files here
    }
}

// Fixed discoverBlogPosts function with better error handling
async function discoverBlogPosts() {
    console.log('Starting blog post discovery for GitHub Pages...');
    
    const posts = [];
    const container = document.getElementById('posts-container');
    
    if (!container) {
        console.error('posts-container element not found');
        return [];
    }
    
    container.innerHTML = '<div class="loading">Discovering blog posts from GitHub...</div>';
    
    try {
        // Get list of files from GitHub API
        const postFiles = await getPostFilesFromGitHub();
        
        if (postFiles.length === 0) {
            console.log('No markdown files found in posts folder');
            container.innerHTML = `
                <div class="info">
                    <strong>No blog posts found!</strong><br>
                    Make sure you have markdown (.md) files in your posts folder:<br>
                    <a href="https://github.com/${GITHUB_REPO.owner}/${GITHUB_REPO.repo}/tree/${GITHUB_REPO.branch}/${GITHUB_REPO.postsFolder}" target="_blank">
                        https://github.com/${GITHUB_REPO.owner}/${GITHUB_REPO.repo}/tree/${GITHUB_REPO.branch}/${GITHUB_REPO.postsFolder}
                    </a>
                </div>
            `;
            return [];
        }
        
        container.innerHTML = `<div class="loading">Loading ${postFiles.length} blog post${postFiles.length !== 1 ? 's' : ''}...</div>`;
        
        // Process each file
        for (const filename of postFiles) {
            console.log(`Processing file: ${filename}`);
            
            try {
                // Fixed: Use correct GitHub Pages domain
                const fileUrl = `https://colorbanded.github.io/${GITHUB_REPO.postsFolder}/${filename}`;
                console.log(`Fetching from GitHub Pages: ${fileUrl}`);
                
                const response = await fetch(fileUrl, {
                    method: 'GET',
                    headers: {
                        'Cache-Control': 'no-cache'
                    }
                });
                
                console.log(`Response for ${filename}:`, response.status, response.statusText);
                
                if (response.ok) {
                    const content = await response.text();
                    console.log(`Content loaded for ${filename}, length:`, content.length);
                    
                    if (content.trim().length === 0) {
                        console.log(`File ${filename} is empty, skipping`);
                        continue;
                    }
                    
                    const parsed = parseFrontmatter(content);
                    
                    const post = {
                        filename: filename,
                        title: parsed.frontmatter.title || filename.replace(/\.(md|html)$/, '').replace(/-/g, ' '),
                        date: parsed.frontmatter.date || new Date().toISOString().split('T')[0],
                        tags: parsed.frontmatter.tags || '',
                        excerpt: parsed.frontmatter.excerpt || extractExcerpt(parsed.content),
                        author: parsed.frontmatter.author || 'colorBanded',
                        content: parsed.content,
                        frontmatter: parsed.frontmatter
                    };
                    
                    console.log('Created post object:', post);
                    posts.push(post);
                    
                    // Update loading message
                    container.innerHTML = `<div class="loading">Loaded ${posts.length} of ${postFiles.length} blog posts...</div>`;
                } else {
                    console.log(`File ${filename} not found (${response.status})`);
                }
            } catch (error) {
                console.error(`Error loading ${filename}:`, error);
            }
        }
        
        console.log('Final posts array:', posts);
        console.log('Posts count:', posts.length);
        
        // Sort posts by date (newest first)
        posts.sort((a, b) => new Date(b.date) - new Date(a.date));
        
        // Display posts - this is the key fix
        if (posts.length > 0) {
            console.log('Calling displayBlogPosts with', posts.length, 'posts');
            displayBlogPosts(posts);
            updateBlogStats(posts);
        } else {
            console.log('No posts loaded, showing empty state');
            container.innerHTML = `
                <div class="info">
                    <strong>No blog posts could be loaded!</strong><br>
                    Found ${postFiles.length} markdown files but couldn't load any content.<br>
                    Make sure your posts are accessible at: <a href="https://colorbanded.github.io/${GITHUB_REPO.postsFolder}/" target="_blank">https://colorbanded.github.io/${GITHUB_REPO.postsFolder}/</a><br>
                    Check the browser console for detailed error messages.
                </div>
            `;
        }
        
        return posts;
        
    } catch (error) {
        console.error('Error in discoverBlogPosts:', error);
        container.innerHTML = `
            <div class="error">
                <strong>Error loading blog posts:</strong><br>
                ${error.message}<br>
                Check the browser console for more details.
            </div>
        `;
        return [];
    }
}

// Fixed displayBlogPosts function
function displayBlogPosts(posts) {
    console.log('Displaying posts:', posts);
    console.log('Posts length:', posts ? posts.length : 'posts is null/undefined');
    
    const container = document.getElementById('posts-container');
    
    if (!container) {
        console.error('posts-container element not found');
        return;
    }
    
    // Fix: Better check for posts array
    if (!posts || !Array.isArray(posts) || posts.length === 0) {
        console.log('No posts to display - posts:', posts);
        container.innerHTML = `
            <div class="info">
                <strong>No blog posts found!</strong><br>
                For GitHub Pages, make sure you have:<br>
                1. Markdown (.md) files in your posts folder<br>
                2. Files committed and pushed to GitHub<br>
                3. Proper frontmatter format (see console for details)<br><br>
                <strong>Repository:</strong> 
                <a href="https://github.com/${GITHUB_REPO.owner}/${GITHUB_REPO.repo}/tree/${GITHUB_REPO.branch}/${GITHUB_REPO.postsFolder}" target="_blank">
                    ${GITHUB_REPO.owner}/${GITHUB_REPO.repo}/${GITHUB_REPO.postsFolder}
                </a><br>
                <strong>Debug info:</strong> Check browser console for details.
            </div>
        `;
        return;
    }
    
    console.log('Building HTML for', posts.length, 'posts');
    let html = '';
    posts.forEach((post, index) => {
        console.log(`Processing post ${index}:`, post.title);
        html += `
            <div class="blog-post">
                <h3><a href="#" onclick="loadBlogPost('${post.filename}'); return false;">${post.title}</a></h3>
                <div class="blog-meta">Posted on ${formatDate(post.date)} | By ${post.author}</div>
                <div class="blog-excerpt">
                    <p>${post.excerpt}</p>
                </div>
                ${post.tags ? `<div class="blog-tags">Tags: ${post.tags.split(',').map(tag => `<a href="#" onclick="filterByTag('${tag.trim()}'); return false;">${tag.trim()}</a>`).join(' ')}</div>` : ''}
            </div>
        `;
    });
    
    console.log('Setting container HTML, length:', html.length);
    container.innerHTML = html;
    console.log('Container updated successfully');
}

// Load individual blog post
async function loadBlogPost(filename) {
    try {
        // Fixed: Use correct GitHub Pages domain
        const fileUrl = `https://colorbanded.github.io/${GITHUB_REPO.postsFolder}/${filename}`;
        console.log(`Loading post from GitHub Pages: ${fileUrl}`);
        
        const response = await fetch(fileUrl);
        if (!response.ok) {
            throw new Error(`Could not load blog post (${response.status})`);
        }
        const content = await response.text();
        const parsed = parseFrontmatter(content);
        
        const blogListing = document.getElementById('blog-listing');
        const blogPost = document.getElementById('blog-post');
        
        if (!blogListing || !blogPost) {
            console.error('Required elements not found');
            return;
        }
        
        blogListing.style.display = 'none';
        blogPost.style.display = 'block';
        
        const postTitle = document.getElementById('post-title');
        const postMeta = document.getElementById('post-meta');
        const postContent = document.getElementById('post-content');
        const postTags = document.getElementById('post-tags');
        
        if (postTitle) postTitle.textContent = parsed.frontmatter.title || 'Blog Post';
        if (postMeta) postMeta.innerHTML = `Posted on ${formatDate(parsed.frontmatter.date)} | By ${parsed.frontmatter.author || 'colorBanded'}`;
        
        if (postContent) {
            if (filename.endsWith('.md')) {
                postContent.innerHTML = parseMarkdown(parsed.content);
            } else {
                postContent.innerHTML = parsed.content;
            }
        }
        
        if (postTags) {
            if (parsed.frontmatter.tags) {
                postTags.innerHTML = 
                    `Tags: ${parsed.frontmatter.tags.split(',').map(tag => `<a href="#" onclick="filterByTag('${tag.trim()}'); return false;">${tag.trim()}</a>`).join(' ')}`;
            } else {
                postTags.innerHTML = '';
            }
        }
        
        if (window.history && window.history.pushState) {
            window.history.pushState({post: filename}, '', `blog.html?post=${filename}`);
        }
        
    } catch (error) {
        console.error('Error loading blog post:', error);
        alert('Error loading blog post: ' + error.message);
    }
}

// Update blog stats
function updateBlogStats(posts) {
    const postCount = document.getElementById('post-count');
    const lastPostDate = document.getElementById('last-post-date');
    
    if (postCount) postCount.textContent = posts.length;
    if (lastPostDate) {
        if (posts.length > 0) {
            lastPostDate.textContent = formatDate(posts[0].date);
        } else {
            lastPostDate.textContent = 'None';
        }
    }
}

// Format date
function formatDate(dateString) {
    if (!dateString) return 'Unknown';
    const date = new Date(dateString);
    const months = ['January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'];
    return `${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
}

// Filter by tag (placeholder)
function filterByTag(tag) {
    alert(`Tag filtering coming soon! You clicked: ${tag}`);
}

// Handle back button
window.addEventListener('popstate', function(event) {
    if (event.state && event.state.post) {
        loadBlogPost(event.state.post);
    } else {
        showBlogListing();
    }
});

// Show blog listing
function showBlogListing() {
    const blogListing = document.getElementById('blog-listing');
    const blogPost = document.getElementById('blog-post');
    
    if (blogListing) blogListing.style.display = 'block';
    if (blogPost) blogPost.style.display = 'none';
    
    if (window.history && window.history.pushState) {
        window.history.pushState({}, '', 'blog.html');
    }
}

// Check URL parameters on load
function checkUrlParams() {
    const urlParams = new URLSearchParams(window.location.search);
    const post = urlParams.get('post');
    if (post) {
        loadBlogPost(post);
    }
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, initializing blog for GitHub Pages...');
    discoverBlogPosts();
    checkUrlParams();
});
</script>
</body>
</html>
